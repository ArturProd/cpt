{% extends '::base.html.twig' %}

{% block main_content %}
<script type="text/javascript">

{# handles the deletion of the post #}
$(function() {         
    $('#delete_post_button').click(function() {
        if (confirm('Voulez vous vraiment supprimer d√©finitivement cet article?'))
        {
            $('#delete_post_form').submit();
        }
    });
});
</script>

<form action="{{ url('cpt_blog_post_delete', { 'id': post.id })}}" method="POST" id="delete_post_form" ></form>
    
<form action="{{ url('cpt_blog_post_edit', { 'id': post.id })}}" method="POST" >

            <div>
              <div class="row-fluid">
                    <div class="span4 offset1">
                      <h1>{{post.id==-1 ? 'title_create_post'|trans({}, 'CptBlogBundle') : 'title_edit_post'|trans({}, 'CptBlogBundle') }}</h1>
                      <p>{{ form_errors(form) }}</p>
                    </div>

                    <div class="span6">
                      {{ form_widget(form.enabled) }}{{ form_label(form.enabled) }}
                      {% if is_granted('ROLE_ADMIN') %}
                      {{ form_widget(form.publishedhomepage) }}{{ form_label(form.publishedhomepage) }}
                      {% endif %}
                      <input type="submit" value="{{'btn_create_post'|trans({}, 'CptBlogBundle') }}" class="btn btn-primary btn-large" />
                      <button type="button" id="delete_post_button" class="btn btn-danger btn-small">Supprimer l'article</button> 

                    </div>
             </div>

              <div class="row-fluid">
                  <div class="span10 offset1">
                      {{ form_widget(form.title) }}
                      {{ form_errors(form.title) }}
                  </div>
              </div>
               <div class="row-fluid">     
                   <div class="span10 offset1">
                      {#{ form_widget(form.rawcontent) }#}
                      {{ form_errors(form.rawcontent) }}
                      {{ form_widget(form.rawcontent) }}     
                  </div>
               </div>
            </div>
</form>
{% endblock %}
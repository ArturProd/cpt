{##############################################################################}
{# JAVASCRIPT
{##############################################################################}
<script type="text/javascript">
{#****************************************************************************#}
{# OnLoad
{#****************************************************************************#}
 $(function() {
    {#****************************************************************************#}
    {# Retreives comments for this post and add them to the form
    {#****************************************************************************#}
     $.get( "{{ url('get_comment_plainhtml', { 'postId': post.id }) }}", function( response ) {    
       
           $("#comment_placeholder_{{ post.id }}").append(response.data);
           $('#button_showhide_comment_{{ post.id }}').show();

     });
    {#****************************************************************************#}     
    {# Clicking on the post header triggers an accordion (slidup / slidedown of posts
    {#****************************************************************************#}
     $("#post_header{{post.id}}").on("click", function(){
         toogle_article({{post.id}},500);
     });
     
    {#****************************************************************************#}     
    {# Changing css class for post header if it is not enabled, and eventually remove "alaune" css class
    {#****************************************************************************#}
     {% if not post.enabled %}
     $("#post_header{{post.id}}").addClass("cpt_grey").removeClass("alaune");
     $("#post_header{{post.id}} > .post_header_title").removeClass("alaune");     
     {% endif %}
         
     {#****************************************************************************#}
     {# Enable context menu to modify a post #}
     {#****************************************************************************#}
     {% if post.canbemodified %}
     $("#post_header{{post.id}}").hover({# on hover on/off post header, show or hide the menu #}
        function(){
             $( "#contextmenucontainer{{post.id}}" ).show();
        },
        function(){
            $( "#contextmenucontainer{{post.id}}" ).hide();
        }
     );
     
     $( "#contextmenucontainer{{post.id}}" ).hide(); {# hide menu by default #}
     $( "#contextmenu{{post.id}}" ).menu(); {# call jquery ui to make a menu #}
     {% endif %}
});
</script>

{#
{#
{##############################################################################}
{# HTML
{##############################################################################}
{#****************************************************************************#}
{# Post Header (title etc.)
{#****************************************************************************#}
<div class="post_header {{post.publishedhomepage ? 'alaune' : '' }}" id="post_header{{post.id}}">
    <div class="post_header_arrow  {{post.publishedhomepage ? 'alaune' : '' }}"></div>
    <div class="post_header_date  {{post.publishedhomepage ? 'alaune' : '' }}">{{post.createdAt|date('d/m') }}</div>
    <div class="post_header_title  {{post.publishedhomepage ? 'alaune' : '' }}">{{ post.title|upper }}</div>
    <div class="post_header_commentcount">{{ post.commentsCount }}</div>
    {% if post.canbemodified %}
    <div id="contextmenucontainer{{post.id}}" class="article_contextmenu">
        <ul id="contextmenu{{post.id}}" class="article_contextmenu">
            <li><a onclick="EditPost({{post.id}})"><span class="ui-icon ui-icon-wrench"></span>Modifier</a></li>
        </ul>
    </div>
    {% endif %}
</div>
<div class="post_subheader" id="post_subheader{{post.id}}">Par {{ post.author }} le {{post.createdAt|date('d/m/YY')}}</div>
{#****************************************************************************#}
{# Post Body (Content etc.)
{#****************************************************************************#}
<div class="post_body" id="post_body{{post.id}}">
    {{ post.rawcontent|raw }}
    {% if post.CanBeModified %}
            <!--button onclick="parent.location='{{ url('cpt_blog_post_edit', { 'id': post.id }) }}'" class="btn btn-success btn-small pull-right">Editer</button!-->
    {% endif %}
</div>
{#****************************************************************************#}
{# Comments
{#****************************************************************************#}
{% render controller("CptBlogBundle:Comment:comments", { 'postId': post.id, '_locale': app.request.locale }) %}


